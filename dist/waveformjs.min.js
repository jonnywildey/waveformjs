/*! waveformjs - v0.0.1 - 2015-09-14
* https://github.com/jonnywildey/waveformjs
* Copyright (c) 2015 Jonny Wildey; Licensed MIT */
function Waveformjs(){return $.extend({},waveformjs)}var waveformjs={audio:null,svgObj:null,pauseButton:null,waveSpiral:null,pauseState:null,playbackHead:null,imageInfo:null,init:function(a){this.svgObj=Snap.select("#svg-"+a),this.waveSpiral=this.svgObj.select("#sp"),this.pauseButton=this.svgObj.select("#pausebutton"),this.playbackHead=this.svgObj.select("#playback-head"),this.pauseButton.click(this.pauseClick.bind(this)),this.pauseState="paused"},initAudio:function(a,b){this.audio=document.createElement("AUDIO"),this.audio.setAttribute("src","audio/"+a),this.audio.volume=.1,this.audio.onloadeddata=b},play:function(){var a=this;a.animate(!0);var b=0;a.audio.play({whileplaying:function(){b++,b%10==0&&(a.animate(!1),a.animate(!0))}}),a.pauseState="playing"},pause:function(){this.audio.pause(),this.animate(!1),this.pauseState="paused"},pauseClick:function(){switch(this.pauseState){case"playing":this.pause(),this.pauseButton.addClass("pausebutton"),this.pauseButton.removeClass("playbutton");break;case"paused":this.play(),this.pauseButton.addClass("playbutton"),this.pauseButton.removeClass("pausebutton")}},animate:function(a){var b=this.audio.duration,c=this.audio.position,d=360*this.imageInfo.totalTurns,e=this.imageInfo.size,f=.5*e,g=f-3*this.imageInfo.innerLabelRadius,h=c/b,i=h*d,j=h*g,k=b-c;a?(this.waveSpiral.stop().animate({transform:"r"+d+","+f+","+f},k),this.playbackHead.stop().animate({transform:"t-"+g+",0"},k)):(this.waveSpiral.stop().transform("r"+i+","+f+","+f),this.playbackHead.stop().transform("t-"+j+",0"))},ready:function(){},run:function(a,b){var c=$("#"+a),d=c.width()>c.height()?c.height():c.width(),e=$("<div/>",{"class":"spiralPlayer",height:d,width:d});$('<object id="svg-'+a+'" type="image/svg+xml" data="/~Jonny/waveformjs/svg/'+b+'.svg"></object>').appendTo(e),e.appendTo(c);var f=document.getElementById("svg-"+a);f.addEventListener("load",function(){this.init(a)}.bind(this)),$.getJSON("json/"+b+".json",function(a){this.imageInfo=a,this.initAudio(b,this.ready.bind(this))}.bind(this))},runSound:function(a,b,c){var d=$("#"+a),e=d.width()>d.height()?d.height():d.width(),f=$("<div/>",{"class":"spiralPlayer",height:e,width:e});$('<object id="svg-'+a+'" type="image/svg+xml" data="/~Jonny/waveformjs/svg/'+c+'.svg"></object>').appendTo(f),f.appendTo(d);var g=document.getElementById("svg-"+a);g.addEventListener("load",function(){this.init(a)}.bind(this)),$.getJSON("json/"+c+".json",function(a){this.imageInfo=a,this.audio=b,this.audio.load()}.bind(this))}};